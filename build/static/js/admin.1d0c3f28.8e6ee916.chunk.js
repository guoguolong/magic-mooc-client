(this["webpackJsonpmagic-mooc"]=this["webpackJsonpmagic-mooc"]||[]).push([[1],{23:function(e,t,a){"use strict";t.a={baseApiUrl:"https://mooc-api.banyuan.club/"}},379:function(e,t,a){e.exports=a(384)},381:function(e,t,a){},382:function(e,t,a){},384:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(41),s=a.n(c),u=a(8),i=a(36),o=(a(72),a(3)),m=a.n(o),l=a(12),p=a(34),d=a(27),b=a(57),f=a(101),E=a(37),v=a(23);function y(){return(y=Object(l.a)(m.a.mark((function e(t){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t/=1,"query($id: Int!){\n        detail (id: $id){\n            id,name,price,summary\n        }\n    }",e.next=4,Object(E.request)(v.a.baseApiUrl+"course","query($id: Int!){\n        detail (id: $id){\n            id,name,price,summary\n        }\n    }",{id:t});case 4:return a=e.sent,e.abrupt("return",a.detail);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return(h=Object(l.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"query($pageNo: Int){\n        list (pageNo: $pageNo){\n            id,name,price,summary\n        }\n    }",e.next=3,Object(E.request)(v.a.baseApiUrl+"course","query($pageNo: Int){\n        list (pageNo: $pageNo){\n            id,name,price,summary\n        }\n    }");case 3:return t=e.sent,e.abrupt("return",t.list);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return(w=Object(l.a)(m.a.mark((function e(t,a){var n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=a||0,a/=1,"\n    mutation($data: CourseInputType!){\n        save (data: $data){\n            id, name, summary, price\n        }\n    }",(n=Object(f.a)({},t)).price=n.price/1,e.prev=5,e.next=8,Object(E.request)(v.a.baseApiUrl+"course","\n    mutation($data: CourseInputType!){\n        save (data: $data){\n            id, name, summary, price\n        }\n    }",{data:n});case 8:return r=e.sent,e.abrupt("return",r.save);case 12:return e.prev=12,e.t0=e.catch(5),e.abrupt("return",{error:100,message:e.t0.message});case 15:case"end":return e.stop()}}),e,null,[[5,12]])})))).apply(this,arguments)}function j(){return(j=Object(l.a)(m.a.mark((function e(t){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t/=1,"mutation($id: Int!){\n        remove (id: $id){\n            error, message\n        }\n    }",e.next=4,Object(E.request)(v.a.baseApiUrl+"course","mutation($id: Int!){\n        remove (id: $id){\n            error, message\n        }\n    }",{id:t});case 4:return a=e.sent,e.abrupt("return",a.remove);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O={getCourseDetail:function(e){return y.apply(this,arguments)},getCourseList:function(){return h.apply(this,arguments)},saveCourse:function(e,t){return w.apply(this,arguments)},deleteCourse:function(e){return j.apply(this,arguments)}},g=(a(381),function(){var e=Object(n.useState)({name:"",id:0,summary:"",price:0}),t=Object(p.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(!1),o=Object(p.a)(s,2),f=o[0],E=o[1],v=Object(n.useState)(""),y=Object(p.a)(v,2),h=y[0],w=y[1],j=Object(i.h)().courseId;return j=j||0,Object(n.useEffect)((function(){Object(l.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.getCourseDetail(j);case 2:(t=e.sent)&&c(t);case 4:case"end":return e.stop()}}),e)})))()}),[j]),r.a.createElement("div",{className:"form-container"},r.a.createElement("h1",null,"Edit Course"),r.a.createElement(u.b,{to:"/admin"},"Back to list"),r.a.createElement(d.d,{enableReinitialize:!0,initialValues:{name:a.name,id:a.id,summary:a.summary,price:a.price},validationSchema:b.a({name:b.b().max(30,"Must be 30 characters or less").required("Title can not be empty"),summary:b.b().max(500,"Must be 500 characters or less").required("Summary can not be empty"),price:b.b().required("Required")}),onSubmit:function(){var e=Object(l.a)(m.a.mark((function e(t,a){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setSubmitting,e.next=3,O.saveCourse(t,j);case 3:(n=e.sent).error?w(n.message):(c(n),E(!0));case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},r.a.createElement(d.c,{className:"course-form form"},f&&r.a.createElement(i.a,{to:"/admin"}),h&&r.a.createElement("div",{className:"error"},h),r.a.createElement("div",{className:"row"},r.a.createElement("label",{htmlFor:"name"},"Title: "),r.a.createElement(d.b,{name:"name",type:"text"}),r.a.createElement(d.a,{name:"name"})),r.a.createElement("div",{className:"row"},r.a.createElement("label",{htmlFor:"summary"},"Intro: "),r.a.createElement(d.b,{name:"summary",as:"textarea"}),r.a.createElement(d.a,{name:"summary"})),r.a.createElement("div",{className:"row"},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"price"},"Price: "),r.a.createElement(d.b,{name:"price",type:"text"})),r.a.createElement("div",null,r.a.createElement(d.a,{name:"price"}))),r.a.createElement("div",{className:"row center"},r.a.createElement("button",{type:"submit"},"Save")))))});a(382);function x(e){var t=e.item,a=e.updateCourses;return r.a.createElement("li",null,r.a.createElement("span",null,t.id),r.a.createElement("span",null,r.a.createElement(u.b,{to:"/admin/course/"+t.id},t.name)),r.a.createElement("span",null,"\xa5",t.price),r.a.createElement("span",{className:"summary",title:t.summary},t.summary),r.a.createElement("span",{className:"button",onClick:Object(l.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.deleteCourse(t.id);case 2:e.sent.error||a(t.id);case 4:case"end":return e.stop()}}),e)})))},"[DELETE]"))}var C=function(){var e=Object(n.useState)([]),t=Object(p.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){Object(l.a)(m.a.mark((function e(){var t,a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=function(e){var n=(a=a.filter((function(t){return t.id!=e}))).map((function(e){return r.a.createElement(x,{key:e.id,item:e,updateCourses:t})}));c(n)},e.next=3,O.getCourseList();case 3:a=e.sent,n=a.map((function(e){return r.a.createElement(x,{key:e.id,item:e,updateCourses:t})})),c(n);case 6:case"end":return e.stop()}}),e)})))()}),[]),r.a.createElement("div",{className:"course-list"},r.a.createElement("h1",null,"Course List"),r.a.createElement(u.b,{to:"/admin/course"},"New Course"),r.a.createElement("ul",null,a))},N=a(55);s.a.render(r.a.createElement(u.a,null,r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"/admin/course/:courseId(\\d+)?"},r.a.createElement(g,null)),r.a.createElement(i.b,{path:"/admin"},r.a.createElement(C,null)))),document.getElementById("root")),N.a()},55:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function n(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},72:function(e,t,a){}},[[379,3,0,6]]]);
//# sourceMappingURL=admin.1d0c3f28.8e6ee916.chunk.js.map