{"version":3,"sources":["store/config.js","store/apis.tsx","store/reducer.ts","store/index.ts","components/Header.tsx","components/course/ArticleContent.tsx","components/course/ArticleTOC.tsx","components/course/Article.tsx","components/course/Chapter.tsx","store/actions.ts","components/Course.tsx","components/Catalog.tsx","components/NotFound.tsx","App.tsx","index.tsx","serviceWorker.ts"],"names":["COURSE_LIST","COURSE_DETAIL","COURSE_SUMMARY","COURSE_SAVE","COURSE_REMOVE","ARTICLE_DETAIL","getApolloClient","ApolloClient","uri","config","id","a","query","variables","resp","data","course","detail","list","body","price","mutate","mutation","update","cache","readQuery","push","writeQuery","e","save","error","message","remove","courseId","summary","articleId","article","getCourseDetail","getCourseList","getCourseSummary","saveCourse","deleteCourse","fetchArticle","combineReducers","state","articles","activeArticle","path_ids_map","action","type","Object","assign","toc","ast","activeTocHash","tocHash","store","createStore","reducer","applyMiddleware","thunkMiddleware","Page","className","href","src","alt","placeholder","connect","content","location","dispatch","useLocation","hash","win","window","useEffect","tObj","document","getElementById","replace","removeEventListener","utils","scrollPosition","scrollTo","left","top","offsetTop","behavior","onscroll","pageYOffset","documentElement","scrollTop","addEventListener","name","dangerouslySetInnerHTML","__html","anchorHash","slice","renderedToc","activeAnchorHash","c","length","createHashByTOCName","n","map","subToc","RenderTocItem","level","key","renderToc","activateTOCAnchor","tocAnchorHash","createTOCAnchorNameByHash","tocs","activeName","subTocContent","onClick","withRouter","useState","mdContent","setMDContent","md","MarkdownIt","html","xhtmlOut","typographer","highlight","str","lang","hljs","getLanguage","value","__","escapeHtml","use","MarkdownItAnchor","permalink","permalinkBefore","require","default","callback","render","parseMD","ArticleContent","ArticleTOC","useParams","iterate","articleMap","activeArticleId","sort","b","seq","item","subMenus","iconStyle","aClass","parent_id","is_active","is_open","active","children","url","to","_iteratePathIds","parentIds","pathIdsMap","values","path_ids","concat","_setActiveArticlePath","paths","currArticle","find","element","fetchCourse","apis","parseInt","start_article_id","actions","Chapter","Article","App","path","Course","exact","Catalog","NotFound","ReactDOM","serviceWorker","Boolean","hostname","match","unregister","navigator","ready","then","registration","catch","console"],"mappings":"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","file":"static/js/main.ec916ccc.chunk.js","sourcesContent":["// const baseApiUrl = 'http://api.magicmooc.org/';\nconst baseApiUrl = 'https://mooc-api.banyuan.club/';\n\nexport default {\n    baseApiUrl\n}","import ApolloClient from 'apollo-boost'\nimport config from './config';\n\n// import { COURSE_LIST, COURSE_DETAIL, COURSE_SUMMARY, COURSE_SAVE, COURSE_REMOVE, ARTICLE_DETAIL } from './gql-bridge'\n\nimport { loader } from 'graphql.macro';\nconst COURSE_LIST = loader('./fixtures/course-list.gql');\nconst COURSE_DETAIL = loader('./fixtures/course-detail.gql');\nconst COURSE_SUMMARY = loader('./fixtures/course-summary.gql');\nconst COURSE_SAVE = loader('./fixtures/course-save.gql');\nconst COURSE_REMOVE = loader('./fixtures/course-remove.gql');\nconst ARTICLE_DETAIL = loader('./fixtures/article-detail.gql');\n\nfunction getApolloClient() {\n    return new ApolloClient({\n        uri: config.baseApiUrl + 'graphql'\n    })    \n}\nasync function getCourseDetail(id: number) {\n    id = id / 1;\n    const resp = await getApolloClient().query({\n        query: COURSE_DETAIL,\n        variables: {\n            id\n        }\n    })\n    return resp.data.course.detail;    \n}\n\nasync function getCourseList() {\n    const resp = await getApolloClient().query({\n        query: COURSE_LIST,\n        // fetchPolicy: 'network-only'\n        // pageNo is an optional arguments, so 'varaibles' is not mandatory.\n    })\n    return resp.data.course.list;\n}\n\nasync function saveCourse(body: any, id?: number) {\n    id /= 1;\n    const data = { ...body }\n    data.price = data.price / 1;\n    try {\n        const resp = await getApolloClient().mutate({\n            mutation: COURSE_SAVE,\n            variables: {\n                data\n            },\n            update: (cache, { data }) => {\n                try {\n                    let { list } = cache.readQuery({ query: COURSE_LIST });\n                    list.push(data);\n                    cache.writeQuery({\n                        query: COURSE_LIST,\n                        data: {\n                            'list': list\n                        }\n                    });\n                } catch (e) {\n                    // We should always catch here,\n                    // as the cache may be empty or the query may fail\n                }\n            }\n        })\n        return resp.data.course.save\n    } catch (e) {\n        return {\n            error: 10,\n            message: e.message\n        }\n    }\n}\n\nasync function deleteCourse(id: number) {\n    id /= 1;\n    const resp = await getApolloClient().mutate({\n        mutation: COURSE_REMOVE,\n        variables: {\n            id\n        }\n    })\n    return resp.data.course.remove;\n}\n\nasync function getCourseSummary(courseId: number) {\n    courseId = courseId / 1;\n    const resp = await getApolloClient().query({\n        query: COURSE_SUMMARY,\n        variables: {\n            courseId\n        }\n    })\n    return resp.data.course.summary;\n}\n\nasync function fetchArticle(articleId: number) {\n    articleId = articleId / 1;\n    const resp = await getApolloClient().query({\n        query: ARTICLE_DETAIL,\n        variables: {\n            id: articleId\n        }\n    })\n    return resp.data.article.detail\n};\n\nexport default {\n    getCourseDetail,\n    getCourseList,\n    getCourseSummary,\n    saveCourse,\n    deleteCourse,\n    fetchArticle,\n}","import { combineReducers } from 'redux'\n\ninterface CouseState {\n    articles: Array<any>,\n    activeArticle: any\n    path_ids_map: any,\n    [propName: string]: any\n}\nfunction course(state: CouseState = {\n    articles: [],\n    activeArticle: {},\n    path_ids_map: {},\n}, action: any) {\n    switch (action.type) {\n        case 'COURSE_FETCHED':\n            return Object.assign({}, state, action.course);\n    }\n    return state;\n}\n\nfunction activeTocHash(state = '', action: any) {\n    switch (action.type) {\n        case 'TOC_ACTIVATE':\n            return action.tocHash;\n    }\n    return state;\n}\n\n\nfunction activeArticle(state = { id: 0 }, action: any) {\n    switch (action.type) {\n        case 'ARTICLE_ACTIVATE':\n            return Object.assign({}, state, action.activeArticle);\n    }\n    return state;\n}\n\nfunction toc(state = {}, action: any) {\n    switch (action.type) {\n        case 'TOC_REFRESH':\n            return Object.assign({}, state, action.ast) || {};\n    }\n    return state;\n}\n\nexport default combineReducers({\n    course,\n    activeArticle,\n    toc,\n    activeTocHash,\n})\n","import thunkMiddleware from 'redux-thunk'\nimport { createStore, applyMiddleware } from 'redux'\nimport reducer from './reducer'\n\nconst store = createStore(reducer, applyMiddleware(thunkMiddleware))\n\n// store.dispatch(fetchCourse());\n\nexport default store","import React from 'react'\n\nexport default function Page() {\n    return (\n        <header className=\"header\">\n            <div className=\"header-left-column\">\n                <div className=\"mobile-button\">\n                    <i className=\"fas fa-bars\"></i>\n                </div>\n                <div className=\"header-logo\">\n                    <div className=\"mobile-logo\">\n                        <a href=\"/\" className=\"logo-link\">\n                            <img src=\"/assets/images/logo.svg\" alt=\"logo\" />\n                        </a>\n                    </div>\n                    <div className=\"desktop-logo\">\n                        <a href=\"/\" className=\"logo-link\">\n                            <img src=\"/assets/images/logo.svg\" alt=\"logo\" />\n                        </a>\n                    </div>\n                </div>\n                <div className=\"mobile-button\">\n                    <i className=\"fas fa-search\"></i>\n                </div>\n            </div>\n            <div className=\"header-inner-wrapper\">\n                <div className=\"header-inner\">\n                    <div className=\"item\">\n                        <a href=\"/courses\">\n                            <span>Catalog</span>\n                        </a>\n                    </div>\n                    <div className=\"item\">\n                        <a href=\"/\">\n                            <span>About</span>\n                        </a>\n                    </div>\n                    <div className=\"item\">\n                        <a href=\"/\">\n                            <span>Term</span>\n                        </a>\n                    </div>\n                    <div className=\"item\">\n                        <a href=\"/\">\n                            <span>Privacy</span>\n                        </a>\n                    </div>\n                </div>\n            </div>\n            <div className=\"search-input-wrapper\">\n                <div className=\"input-container\">\n                    <i className=\"fa fa-search\"></i>\n                    <input placeholder=\"Search...\" />\n                </div>\n            </div>\n        </header>\n    )\n}","import React, { useEffect } from 'react'\nimport { connect } from 'react-redux'\nimport { useLocation } from 'react-router-dom'\n\nconst mapStateToProps = (state: any) => {\n    return {\n        course: state.course,\n        activeTocHash: state.activeTocHash,\n    }\n}\nexport default connect(mapStateToProps)(ArticleContent)\n\nfunction ArticleContent({ course, content, activeTocHash, dispatch }: any) {\n    const location = useLocation();\n    activeTocHash = location.hash || activeTocHash;\n    let win:any = window;\n    useEffect(() => {\n        if (!content) return;\n        if (activeTocHash && location.hash) {\n            const tObj: any = document.getElementById(activeTocHash.replace(/^#/, ''));\n            if (tObj) {\n                win.removeEventListener(\"scroll\", win.utils.scrollPosition);\n                window.scrollTo({\n                    left: 0,\n                    top: tObj.offsetTop,\n                    behavior: 'smooth'\n                })\n                window.onscroll = (e:any) => {\n                    let currentScrollOffset = window.pageYOffset || document.documentElement.scrollTop\n                    if (currentScrollOffset === tObj.offsetTop) {\n                        window.onscroll = null;\n                        win.addEventListener(\"scroll\", win.utils.scrollPosition);\n                    }\n                }\n                // setTimeout(function(){\n                //     win.addEventListener(\"scroll\", win.utils.scrollPosition);\n                // }, 2000)\n            }\n        }\n\n    })\n    return (\n        <div className=\"page-container\">\n            <div className=\"page-header\">\n                <div className=\"page-header-inner\">\n                    <h1>{course.activeArticle.name}</h1>\n                    <i className=\"fas fa-list-ul mobile-toc-icon\"></i>\n                </div>\n            </div>\n            <div className=\"page-body\" dangerouslySetInnerHTML={{ __html: content }}>\n            </div>\n            <div className=\"page-footer\">\n            </div>\n        </div>\n    )\n}","import React, { useEffect } from 'react'\nimport { connect } from 'react-redux'\nimport { useLocation } from 'react-router-dom'\n\nconst mapStateToProps = (state: any) => {\n    return {\n        toc: state.toc\n    }\n}\n\nexport default connect(mapStateToProps)(ArticleTOC)\nfunction ArticleTOC({ toc, dispatch }: any) {\n    const location  = useLocation();\n    const anchorHash = location.hash.slice(1);\n    const renderedToc = renderToc(toc, anchorHash);\n    useEffect(()=>{\n        win.utils.activateTOCAnchor(anchorHash, true)\n        dispatch({\n            type: \"TOC_ACTIVATE\",\n            tocHash: activeTocHash\n        })\n    })\n    return (\n        <div className=\"page-side\">\n            <div className=\"sticky-container\">\n                <div className=\"toc-wrapper\">\n                    <div className=\"toc-inner\">\n                        <div className=\"toc-inner-content\">\n                            <div className=\"indicator\" id=\"indicator\"></div>\n                            <div className=\"toc-header\">\n                                <i className=\"fas fa-list-ul toc-icon\"></i>\n                                <span className=\"toc-title\">CONTENTS</span>\n                            </div>\n                            <div className=\"toc-content\">\n                                <ul className=\"toc-items\">\n                                    {renderedToc}\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n    )\n}\n\nlet activeTocHash = '';\nconst win:any = window;\nfunction renderToc(toc: any, activeAnchorHash: string) {\n    if (!toc || !toc.c || !toc.c.length) return;\n    if (!activeAnchorHash) {\n        activeAnchorHash = win.utils.createHashByTOCName(toc.c[0].n); \n    }\n\n    const content = toc.c.map((subToc: any) => {\n        return <RenderTocItem level=\"1\" key={subToc.n} toc={subToc} activeAnchorHash={activeAnchorHash} />;\n    })\n    return (content);\n}\n\nfunction RenderTocItem({ level, toc, activeAnchorHash }: any) {\n    activeAnchorHash = activeAnchorHash || '';\n    let anchorHash = win.utils.createHashByTOCName(toc.n);\n    let tocAnchorHash = win.utils.createTOCAnchorNameByHash(anchorHash);\n    win.tocs.push(anchorHash)\n\n    let activeName = (toc.n && activeAnchorHash === anchorHash) ? 'active' : ''\n    if (activeName) {\n        activeTocHash = anchorHash\n    }\n\n    let subTocContent = [];\n    if (toc.c) {\n        subTocContent = toc.c.map((subToc: any) => {\n            return <RenderTocItem key={subToc.n} toc={subToc} activeAnchorHash={activeAnchorHash} />;\n        })\n    }\n    return (\n        <li id={tocAnchorHash}>\n            <a href={'#' + anchorHash} onClick={()=>{\n                win.utils.activateTOCAnchor(anchorHash, true)\n            }} className={activeName}><div>{toc.n}</div></a>\n            {subTocContent.length > 0 &&\n                <ul>\n                    {subTocContent}\n                </ul>\n            }\n        </li>\n    );\n}","import React, { useEffect, useState } from 'react'\nimport { connect } from 'react-redux'\n\nimport ArticleContent from './ArticleContent'\nimport ArticleTOC from './ArticleTOC'\nimport MarkdownIt from 'markdown-it';\nimport MarkdownItAnchor from 'markdown-it-anchor'\n//  import MarkdownItTocDoneRight from 'markdown-it-toc-done-right'\nimport hljs from 'highlight.js';\nimport 'highlight.js/styles/solarized-dark.css';\nimport { withRouter } from 'react-router-dom'\n\nconst mapStateToProps = (state: any) => {\n    return {\n        course: state.course,\n    }\n}\n\nfunction parseMD(course: any, dispatch: any) {\n    const mdContent = course.activeArticle ? course.activeArticle.content : '';\n\n    function tocCallback(html: any, ast: any) {\n        dispatch({\n            type: 'TOC_REFRESH',\n            ast\n        })\n    };\n\n    const md: any = MarkdownIt({\n        html: true,\n        xhtmlOut: true,\n        typographer: true,\n        highlight: function (str, lang) {\n            if (lang && hljs.getLanguage(lang)) {\n                try {\n                    return '<pre class=\"hljs\"><code>' +\n                        hljs.highlight(lang, str, true).value +\n                        '</code></pre>';\n                } catch (__) { }\n            }\n\n            return '<pre class=\"hljs\"><code>' + md.utils.escapeHtml(str) + '</code></pre>';\n        }\n    }).use(MarkdownItAnchor, {\n        permalink: true,\n        permalinkBefore: true,\n        // permalinkSymbol: '§',\n    }).use(require('markdown-it-toc-done-right').default, {\n        callback: tocCallback\n    });\n    return md.render(mdContent)\n}\n\nexport default connect(mapStateToProps)(withRouter(Article))\n\nfunction Article({ course, dispatch }: any) {\n    const  [mdContent, setMDContent] = useState('');\n    useEffect(() => {\n        if (course.id) {\n            const content = parseMD(course, dispatch);\n            if (mdContent !== content) {\n                setMDContent(content);\n            }\n        }\n    }, [course]);\n    return (\n        <div className=\"whole-content-page\">\n            <div className=\"whole-content-sticky\">\n                <ArticleContent course={course} content={mdContent}></ArticleContent>\n                <ArticleTOC />\n            </div>\n        </div>\n    )\n}","import React from 'react'\nimport { connect } from 'react-redux'\nimport { Link, useParams } from 'react-router-dom'\n\nconst mapStateToProps = (state: any) => {\n    return {\n        course: state.course,\n    }\n}\nexport default connect(mapStateToProps)(Chapter)\nfunction Chapter({ course, dispatch }: any) {\n    const {courseId, articleId} =  useParams();\n    const list = iterate(course.articles, courseId, articleId);\n    return (\n        <div className=\"content-nav\" id=\"sidebar\">\n            <div className=\"content-nav-inner\">\n                <div className=\"course-name\">{course.name}</div>\n                <ul>\n                    {list}\n                </ul>\n            </div>\n        </div>\n    )\n}\n\nfunction iterate(articleMap: Array<any>, courseId:string, activeArticleId:string, level?: number): any {\n    level = level || 1;\n    let articles = articleMap;\n    // Object.values(articleMap);\n    articles = articles.sort(function(a:any, b:any):number {\n        return (a.seq < b.seq) ? -1: 1;\n    })\n    return articles.map((item: any) => {\n        let subMenus = <></>;\n        let iconStyle = 'fas';\n        let aClass = item.parent_id ? '' : 'top';\n        if (item.is_active) {\n            aClass += ' active';\n        }\n        if (item.id === activeArticleId) {\n            item.is_open = true;\n            item.active = true;\n        }\n        if (item.children) {\n            if (item.is_open) {\n                iconStyle += ' fa-chevron-down'\n                level = level || 1;\n                subMenus = iterate(item.children, courseId, activeArticleId, level + 1);\n            } else {\n                iconStyle += ' fa-chevron-right'\n            }\n        }\n        let url = `/course/${courseId}/${item.id}`;\n        return <li key={item.name}>\n            <Link className={aClass} to={url}>\n                <span>{item.name}</span>\n                {item.children ? <i className={iconStyle}></i> : ''}\n            </Link>\n            {!item.children ? '' :\n                <ul className=\"sub-menu\">\n                    {subMenus}\n                </ul>\n            }\n        </li>\n    });\n}","import { Course } from '../datatypes'\nimport apis from './apis';\n\nfunction _iteratePathIds(articles: Array<any>, parentIds?: Array<number>) {\n    let pathIdsMap: any = {}\n    Object.values(articles).map(item => {\n        parentIds = parentIds || []\n        item.path_ids = parentIds.concat(item.id);\n        pathIdsMap[item.id] = item.path_ids;\n        if (item.children) {\n            const b = _iteratePathIds(item.children, item.path_ids);\n            pathIdsMap = Object.assign(pathIdsMap, b)\n        }\n        return true;\n    })\n    return pathIdsMap;\n}\n\nfunction _setActiveArticlePath(articles: Array<any>, paths: Array<number>) {\n    paths = paths || [];\n    // const currArticle = articles[paths[0]]; // for branch 'master', it's a map\n    const currArticle = articles.find(element => element.id === paths[0]);\n    if (!currArticle) return;\n    currArticle.is_open = true;\n    if (paths.length === 1) { // 路径中的最后一个节点(当前节点)\n        currArticle.is_active = true;\n    }\n    if (currArticle.children) {\n        _setActiveArticlePath(currArticle.children, paths.slice(1));\n    }\n}\n\nexport function fetchCourse(courseId?: number, articleId?: number) {\n    courseId = courseId || 10;\n    let course: Course = {\n        articles: []\n    };\n    return async function (dispatch: any) {\n        course = await apis.getCourseSummary(courseId)\n        if (!articleId) {\n            articleId = parseInt(course.start_article_id);\n        } else {\n            course.activeArticle = await apis.fetchArticle(articleId);\n        }\n\n        course.path_ids_map = _iteratePathIds(course.articles);\n        _setActiveArticlePath(course.articles, course.path_ids_map[articleId])\n\n        dispatch({\n            type: 'COURSE_FETCHED',\n            course: course\n        })\n    }\n};\n\nexport default {\n    fetchCourse,\n}","import React, { useEffect } from 'react'\nimport Article from './course/Article'\nimport Chapter from './course/Chapter'\nimport actions from '../store/actions'\nimport { useParams } from 'react-router-dom'\nimport { connect } from 'react-redux'\n\nconst mapStateToProps = (state: any) => {\n    return {\n    }\n}\nexport default connect(mapStateToProps)(Course)\nfunction Course({ dispatch}: any) {\n    let { courseId, articleId } = useParams();\n    courseId = courseId || 10;\n    useEffect(() => {\n        dispatch(actions.fetchCourse(courseId, articleId))\n    }, [courseId, articleId])\n    return (\n        <div className=\"body-container\">\n            <Chapter />\n            <Article />\n        </div>\n    )\n}","import React from 'react'\nimport '../assets/styles/catalog.less'\n\nexport default function () {\n    // https://www.codecademy.com/catalog/subject/all\n    return (\n        <ul className=\"catalog\">\n            <li className=\"card-item\">\n                <a href=\"/course/10\">\n                    <div className=\"card-item-inner\">\n                        <div className=\"logo\">\n                            <img alt=\"course title\" src=\"/assets/images/2.svg\" />\n                        </div>\n                        <div className=\"summary\">\n                            <h3 className=\"title\">\n                                C Language\n                            </h3>\n                            <p className=\"intro\">\n                                Looking for an introduction to the theory behind programming? Master C while learning data structures, algorithms, and more!\n                            </p>\n                            <ul className=\"tags\">\n                                <li>C</li>\n                                <li>Data Structure</li>\n                                <li>Command Line</li>\n                                <li>Git</li>\n                            </ul>\n                        </div>\n                    </div>\n                </a>\n            </li>\n            <li className=\"card-item\">\n                <a href=\"/course/20\">\n                    <div className=\"card-item-inner\">\n                        <div className=\"logo\">\n                            <img alt=\"course title\" src=\"/assets/images/1.svg\" />\n                        </div>\n                        <div className=\"summary\">\n                            <h3 className=\"title\">\n                            Foundation of CS\n                            </h3>\n                            <p className=\"intro\">\n                                Interested in learning how to code, but unsure where to start? This is the path for you!\n                            </p>\n                            <ul className=\"tags\">\n                                <li>Computer Science History</li>\n                                <li>Career Exploration</li>\n                                <li>Application</li>\n                            </ul>\n                        </div>\n                    </div>\n                </a>\n            </li>\n        </ul>\n    )\n}","import React from 'react'\n\nexport default function() {\n    return (\n        <div className=\"page-not-found\">\n            <h1>Page Not Found.</h1>\n        </div>\n    )\n}","import React from 'react'\nimport { Provider} from 'react-redux'\nimport { BrowserRouter as Router, Switch, Route, Redirect} from 'react-router-dom'\nimport store from './store/index';\n\nimport Header from './components/Header'\nimport Course from './components/Course'\nimport Catalog from './components/Catalog'\nimport NotFound from './components/NotFound'\n\nexport default function App() {\n    return (\n        <Provider store={store}>\n            <Router>\n                <div>\n                    <Header></Header>\n                    <Switch>\n                        <Route path=\"/course/:courseId/:articleId?\">\n                            <Course />\n                        </Route>\n                        <Route path=\"/courses\">\n                            <Redirect to=\"/\"/>\n                        </Route>\n                        <Route exact path=\"/index.html\">\n                            <Redirect to=\"/\"/>\n                        </Route>\n                        <Route exact path=\"/\">\n                            <Catalog />\n                        </Route>\n                        <Route path=\"*\">\n                            <NotFound />\n                        </Route>\n                    </Switch>\n                </div>\n            </Router>\n        </Provider>\n    )\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  // <React.StrictMode>\n    <App />\n  // </React.StrictMode>\n  ,document.getElementById('root')\n);\n\nserviceWorker.unregister();\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n"],"sourceRoot":""}